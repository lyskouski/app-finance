app-id: com.tercad.fingrom
runtime: org.gnome.Platform
runtime-version: "47"
sdk: org.gnome.Sdk
command: fingrom
separate-locales: false
finish-args:
  - --socket=fallback-x11
  - --socket=wayland
  - --socket=pulseaudio
  - --share=network
  - --share=ipc
  - --device=dri
  - --filesystem=xdg-documents/.terCAD:create
modules:
  - name: zenity
    buildsystem: meson
    sources:
      - type: archive
        url: https://download.gnome.org/sources/zenity/4.0/zenity-4.0.2.tar.xz
        sha256: c16dcae46e29e22c2fa0b95e80e06c96b2aec93840161369c95c85ed9f093153

  - name: Fingrom
    buildsystem: simple
    only-arches:
      - x86_64
    build-commands:
      - mkdir -p Fingrom
      - tar -xf fingrom_Linux.tar.gz -C Fingrom
      - cp -r Fingrom /app/Fingrom
      - chmod +x /app/Fingrom/fingrom
      - mkdir -p /app/bin
      - ln -s /app/Fingrom/fingrom /app/bin/fingrom
      - export XDG_DATA_HOME="/var/lib/flatpak/exports/share:$XDG_DATA_HOME"
      - export XDG_DATA_DIRS="/var/lib/flatpak/exports/share:$XDG_DATA_DIRS"
      - install -Dm644 /app/Fingrom/com.tercad.fingrom.svg /app/share/icons/hicolor/scalable/apps/com.tercad.fingrom.svg
      - install -Dm644 /app/Fingrom/com.tercad.fingrom.desktop /app/share/applications/com.tercad.fingrom.desktop
      - install -Dm644 com.tercad.fingrom.metainfo.xml /app/share/appdata/com.tercad.fingrom.metainfo.xml
    sources:
      - type: file
        url: https://github.com/lyskouski/app-finance/releases/download/v{VERSION}/fingrom_Linux.tar.gz
        sha256: "{SHA256}"
      - type: file
        path: com.tercad.fingrom.metainfo.xml
